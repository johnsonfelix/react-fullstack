generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}


datasource d {
  provider  = "postgresql"
  url       = env("POSTGRES_PRISMA_URL")
  directUrl = env("POSTGRES_URL_NON_POOLING")
}


model User {
  id               String     @id @default(cuid())
  username         String     @unique
  password         String
  email            String?    @unique
  type             String
  profileCompleted Boolean    @default(false)
  createdAt        DateTime   @default(now()) @map(name: "created_at")
  updatedAt        DateTime   @updatedAt @map(name: "updated_at")

  supplier         Supplier?  @relation("UserSupplier", fields: [supplierId], references: [id])
  supplierId       String?    @unique

  approver         Approver?  @relation("UserApprover")

  @@map(name: "users")
}

model Supplier {
  id                    String    @id @default(cuid())
  
  // Company Details (Step 1)
  companyName           String
  registrationEmail     String    @unique
  website               String?
  country               String
  tradeLicenseNumber    String?
  taxRegistrationNumber String?
  organizationType      String
  supplierType          String
  noteToApprover        String?
  profileAttachments    String[]  // Array of file URLs
  
  // Relationships
  contacts              Contact[]
  addresses             Address[]
  businessDocuments     BusinessDocument[]
  bankAccounts          BankAccount[]
  questionnaireResponse QuestionnaireResponse?
  questionnaireAnswers  QuestionnaireAnswer[]
  user                  User?        @relation("UserSupplier")

  registrationStatus     String?  // e.g. "DRAFT", "FORM_SUBMITTED", "APPROVED"
  registrationReference  String?  // unique/visible id for the user
  registrationSubmittedAt DateTime?
  
  // Add these relation fields to satisfy Category and ProcurementRequest relations:
  productCategories     SupplierCategory[]
  procurementRequests   ProcurementRequest[]     @relation("ProcurementRequestSuppliers")
  
  eventParticipations   EventParticipation[]
  rfpResponses          RfpResponse[]
  catalogItems          CatalogItem[]

  // Metadata
  status                String    @default("pending") // pending, approved, rejected
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  submittedAt           DateTime?
  
  @@map("suppliers")
}

model CatalogItem {
  id          String   @id @default(cuid())
  itemType    String
  description String
  quantity    Int
  price       Float
  imageUrl    String?
  supplierPartId String?

  supplierId  String
  supplier    Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)

  categoryId  String
  category    ProductCategory @relation(fields: [categoryId], references: [id])

  uomId       String
  uom         Uom      @relation(fields: [uomId], references: [id])

  currencyId  String
  currency    Currency @relation(fields: [currencyId], references: [id])

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("catalog_items")
}

// Step 2: Contacts
model Contact {
  id                      String   @id @default(cuid())
  firstName               String
  lastName                String
  email                   String
  designation             String?
  countryCode             String
  mobile                  String
  isAdministrativeContact Boolean  @default(false)
  needsUserAccount        Boolean  @default(false)
  phone                   String?  // ADD THIS LINE
  ext                     String?  // ADD THIS LINE
  
  supplier                Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  supplierId              String
  
  createdAt               DateTime @default(now())
  updatedAt               DateTime @updatedAt
  
  @@map("contacts")
}

// Step 3: Addresses
model Address {
  id          String   @id @default(cuid())
  type        String
  line1       String
  line2       String?
  line3       String?
  city        String
  state       String
  postalCode  String
  country     String
  usage              Json? 
  associatedContacts Json? 
  
  supplier    Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  supplierId  String
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@map("addresses")
}

// Step 4: Business Documents
model BusinessDocument {
  id                  String    @id @default(cuid())
  classification      String    // e.g., "INSURANCE", "CERTIFICATION"
  subClassification   String?
  certifyingAgency    String?
  certificateNumber   String?
  certificateStartDate DateTime?
  certificateEndDate  DateTime?
  otherCertifyingAgency String?
  notes               String?
  attachments         String[]  // Array of file URLs
  
  supplier            Supplier  @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  supplierId          String
  
  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt
  
  @@map("business_documents")
}

// Step 5: Bank Accounts
model BankAccount {
  id            String   @id @default(cuid())
  country       String
  currency      String
  accountType   String 
  bankName      String
  accountNumber String
  accountHolder String
  bankBranch    String? 
  iban          String?
  swiftCode     String?
  
  supplier      Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  supplierId    String
  
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  @@map("bank_accounts")
}

//  model Category {
//    id              String      @id @default(cuid())
//    name            String
//    createdAt       DateTime    @default(now()) @map(name: "created_at")
//    updatedAt       DateTime    @updatedAt @map(name: "updated_at")
//  
//    // Self-referencing fields
//    parentCategoryId String?     
//    parentCategory   Category?   @relation("SubCategories", fields: [parentCategoryId], references: [id])
//    subcategories    Category[]  @relation("SubCategories")
//  
//    suppliers        Supplier[]  @relation("SupplierCategories")
//  }

// Step 6: Product Categories
model ProductCategory {
  id          String             @id @default(cuid())
  name        String
  parentId    String?
  description String?
  parent      ProductCategory?   @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children    ProductCategory[]  @relation("CategoryHierarchy")

  suppliers   SupplierCategory[] // join records

  createdAt   DateTime           @default(now())
  updatedAt   DateTime           @updatedAt

  catalogItems CatalogItem[]

  @@map("product_categories")
}

// join table already present in your schema — leave as-is
model SupplierCategory {
  id              String          @id @default(cuid())

  supplier        Supplier        @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  supplierId      String

  productCategory ProductCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  categoryId      String

  createdAt       DateTime        @default(now())

  @@unique([supplierId, categoryId])
  @@map("supplier_categories")
}

// Step 7: Questionnaire

 model QuestionnaireTemplate {
   id          String                  @id @default(cuid())
   name        String
   description String?
   isActive    Boolean                 @default(true)
   // each template belongs to a category (required per your request)
   categoryId  String
   category    QuestionnaireCategory   @relation(fields: [categoryId], references: [id], onDelete: Cascade)
   questions   QuestionnaireQuestion[]
   createdAt   DateTime                @default(now())
   updatedAt   DateTime                @updatedAt

   @@map("questionnaire_templates")
 }

 model QuestionnaireCategory {
   id         String                 @id @default(cuid())
   name       String
   order      Int                    @default(0)
   // a category may have many templates
   templates  QuestionnaireTemplate[]
   // questions can also reference this category (optional)
   questions  QuestionnaireQuestion[] 

   createdAt  DateTime               @default(now())
   updatedAt  DateTime               @updatedAt

   @@map("questionnaire_categories")
 }

// Questions in a template
model QuestionnaireQuestion {
  id               String                @id @default(cuid())
  text             String
  description      String?
  type             String                @default("text")
  required         Boolean               @default(false)
  order            Int                   @default(0)

  options          Json?
  validation       Json?

  // attachments array (fixed)
  attachments      String[]              @default([])

  // category relation (optional)
  categoryId       String?
  category         QuestionnaireCategory? @relation(fields: [categoryId], references: [id])

  // template relation
  templateId       String
  template         QuestionnaireTemplate @relation(fields: [templateId], references: [id], onDelete: Cascade)

  // nested/sub-question self-relation
  parentQuestionId String?
  parentQuestion   QuestionnaireQuestion? @relation("SubQ", fields: [parentQuestionId], references: [id])
  subQuestions     QuestionnaireQuestion[] @relation("SubQ")

  answers          QuestionnaireAnswer[]

  createdAt        DateTime              @default(now())
  updatedAt        DateTime              @updatedAt

  @@map("questionnaire_questions")
}

// Supplier's answers
model QuestionnaireAnswer {
  id         String                @id @default(cuid())
  answer     Json                  // Flexible storage for any answer type
  
  questionId String
  question   QuestionnaireQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)
  
  supplierId String
  supplier   Supplier              @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  
  createdAt  DateTime              @default(now())
  updatedAt  DateTime              @updatedAt
  
  @@unique([questionId, supplierId])
  @@map("questionnaire_answers")
}

model QuestionnaireResponse {
  id                            String   @id @default(cuid())
  
  // Declarations
  hasQualityManagementSystem    Boolean  @default(false)
  hasEnvironmentalCertification Boolean  @default(false)
  hasHealthSafetyCertification  Boolean  @default(false)
  acceptsTermsAndConditions     Boolean  @default(false)
  
  // Minimum Required Documents
  hasBusinessLicense            Boolean  @default(false)
  hasTaxCertificate             Boolean  @default(false)
  hasInsuranceCertificate       Boolean  @default(false)
  
  // F&B Specific (if applicable)
  hasFoodSafetyCertificate      Boolean  @default(false)
  hasHalalCertificate           Boolean  @default(false)
  hasOrganicCertificate         Boolean  @default(false)
  
  // Additional responses
  additionalNotes               String?
  
  supplier                      Supplier @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  supplierId                    String   @unique
  
  createdAt                     DateTime @default(now())
  updatedAt                     DateTime @updatedAt
  
  @@map("questionnaire_responses")
}


model Currency {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
  catalogItems CatalogItem[]
}

model Incoterms {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model ServiceType {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model Carrier {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}


model Payment {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model Shipping {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model Uom {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
  catalogItems CatalogItem[]
}

model Urgency {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model BRFQ {
  id                    String   @id @default(uuid())
  rfqId                 String   @unique
  title                 String
  openDate              DateTime?
  closeDate             DateTime
  closeTime             DateTime
  needByDate            DateTime?
  preferredDeliveryTime String?
  requester             String?
  shippingAddress       String?
  paymentProcess        String
  currency              String
  shippingType          String?
  carrier               String?
  urgency               String?
  notesToSupplier       String?
  incoterms             String?
  origin                String?
  currentPrice          String?
  targetPrice           String?
  prValue               String?
  productSpecification  String?
  customerCategory      String[]
  suppliersSelected     Json?
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt

  items                 RequestItem[]
  suppliers             String[]

  attachmentPath        String?

  // ✅ Add this reverse relation
  quotes                Quote[]  @relation("BRFQToQuotes")
  modificationRequests  ModificationRequest[]
  award   Award[]


  pauseRequests  PauseRequest[]   // all pause requests created for this BRFQ
  pauseActions   PauseAction[]    // chronological pause/resume actions

  publishOnApproval     Boolean  @default(false)   // if true, will be published automatically when approved
  approvalStatus        String   @default("none")  // "none" | "pending" | "approved" | "rejected"
  approvalRequestedBy   String?                        // user id / username who sent for approval
  approvalRequestedAt   DateTime?
  approvedBy            String?
  approvedAt            DateTime?
  approvalNote          String?                        // optional note from approver when approving/rejecting
  published             Boolean  @default(false)      // whether RFQ is published (visible to suppliers)
  status                String?  
}



model RequestItem {
  id             String   @id @default(uuid())
  brfqId         String
  internalPartNo String?
  manufacturer   String?
  mfgPartNo      String?
  description    String
  uom            String   // store name directly
  quantity       Int

  brfq           BRFQ     @relation(fields: [brfqId], references: [id], onDelete: Cascade)
}

model Quote {
  id               String   @id @default(uuid())
  supplierQuoteNo  String
  validFor         String
  currency         String
  shipping         String
  comments         String?
  attachments      Json?    // Added for supplier attachments
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  rfqId            String?
  supplierId       String
  
  // Relations
  rfq              BRFQ?    @relation("BRFQToQuotes", fields: [rfqId], references: [id])
  
  // New Relation to ProcurementRequest
  procurementRequestId String?
  procurementRequest   ProcurementRequest? @relation(fields: [procurementRequestId], references: [id])
  
  items            QuoteItem[]
}

model QuoteItem {
  id             String   @id @default(uuid())
  quoteId        String
  quote          Quote    @relation(fields: [quoteId], references: [id])

  supplierPartNo String?
  deliveryDays   String?
  unitPrice      Float
  qty            Int
  uom            String?
  cost           Float?
  
  // Link to specific item in the request
  procurementItemId String?
  procurementItem   ProcurementItem? @relation(fields: [procurementItemId], references: [id])
}

model ProcurementItem {
  id              String               @id @default(cuid())
  title           String
  quantity        Int
  price           Int?
  manufacturerPartNo   String?
  uom             String?
  location        String?      // Added for delivery location
  attachment      String?      // Added for line item attachment
  procurementId   String
  procurement     ProcurementRequest   @relation(fields: [procurementId], references: [id], onDelete: Cascade)
  
  quoteItems      QuoteItem[]
}

model ProcurementRequest {
  id          String                    @id @default(cuid())
  title       String
  description String?
  sowSummary  String?   // Added for SOW persistence
  deliverables Json?    // Changed to Json to store { text, checked } objects
  terms       Json?    // Added to store terms sections and clauses
  attachments Json?    // Added to store file attachments metadata
  requestType String
  category    String
  address     String
  scopeOfWork ScopeOfWorkDeliverable[]
  status      String                    @default("draft")
  evaluationSections EvaluationSection[]
  evaluationDetails Json?
  items       ProcurementItem[]
  questions   Question[] 
  aiQuestions Json?
  additionalFields Json?
  suppliers   Supplier[] @relation("ProcurementRequestSuppliers")
  
  eventParticipations EventParticipation[]

  procurementLead    ProcurementLead? @relation(fields: [procurementLeadId], references: [id])
  procurementLeadId  String?

  createdAt   DateTime                  @default(now())
  updatedAt   DateTime                  @updatedAt



  collaborators ProcurementCollaborator[]
  approval      ProcurementApproval?
  quotes        Quote[]
  rfpResponses  RfpResponse[]
}

model ProcurementApproval {
  id                    String             @id @default(cuid())
  procurementRequestId  String             @unique
  procurementRequest    ProcurementRequest @relation(fields: [procurementRequestId], references: [id], onDelete: Cascade)
  
  steps                 ApprovalStep[]
  
  // Settings from the UI
  defaultSla            String?            // "2 business days"
  allowParallel         Boolean            @default(false)
  sendReminders         Boolean            @default(true)
  allowDelegation       Boolean            @default(false)
  
  createdAt             DateTime           @default(now())
  updatedAt             DateTime           @updatedAt
  
  @@map("procurement_approvals")
}

model ApprovalStep {
  id                    String             @id @default(cuid())
  approvalId            String
  approval              ProcurementApproval @relation(fields: [approvalId], references: [id], onDelete: Cascade)
  
  order                 Int
  role                  String             // "Procurement Lead", "Finance"
  approverName          String?            // "Sarah Johnson"
  status                String             // "PENDING", "APPROVED", "REJECTED", "CONDITIONAL", "FUTURE"
  
  slaDuration           String?            // "48 hrs" 
  condition             String?            // "Always required", "If budget > 50k" (legacy/display)
  
  // Structured Conditionals
  conditionType         String?            // "Budget", "Contract Duration", "ESG Questions"
  conditionOperator     String?            // ">", "<", "=", "Present"
  conditionValue        String?            // "50000", "Yes"
  
  isRequired            Boolean            @default(false)
  
  comments              String?
  
  createdAt             DateTime           @default(now())
  updatedAt             DateTime           @updatedAt
  
  @@map("approval_steps")
}

model ProcurementCollaborator {
  id                    String             @id @default(cuid())
  name                  String
  email                 String?
  role                  String             // "Approver", "Technical Evaluator", "Spectator", etc.
  permissions           String[]           // ["view_technical", "edit", "score"]
  
  procurementRequestId  String
  procurementRequest    ProcurementRequest @relation(fields: [procurementRequestId], references: [id], onDelete: Cascade)
  
  userId                String?            // Optional link to actual User model if they have account
  
  createdAt             DateTime           @default(now())
  updatedAt             DateTime           @updatedAt

  @@map("procurement_collaborators")
}

model ProcurementLead {
  id        String   @id @default(cuid())
  name      String
  email     String?
  department String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  procurementRequests ProcurementRequest[]
}

model ScopeOfWorkDeliverable {
  id             String             @id @default(cuid())
  text           String
  checked        Boolean            @default(false)
  
  procurementRequestId String
  procurementRequest   ProcurementRequest @relation(fields: [procurementRequestId], references: [id], onDelete: Cascade)
}

model EvaluationSection {
  id             String             @id @default(cuid())
  title          String             // "Technical", "Commercial", "Compliance"
  weight         Int                // 40, 60, etc.
  
  criteria       EvaluationCriterion[]
  
  procurementRequestId String
  procurementRequest   ProcurementRequest @relation(fields: [procurementRequestId], references: [id], onDelete: Cascade)
}

model EvaluationCriterion {
  id             String             @id @default(cuid())
  question       String
  maxScore       Int                @default(10)
  
  sectionId      String
  section        EvaluationSection  @relation(fields: [sectionId], references: [id], onDelete: Cascade)
}

model Question {
  id             String             @id @default(cuid())
  text           String
  type           String             // "text", "yesno", "file"
  required       Boolean            @default(false)
  order          Int
  
  procurementRequestId String
  procurementRequest   ProcurementRequest @relation(fields: [procurementRequestId], references: [id], onDelete: Cascade)
}

model ModificationRequest {
  id        String   @id @default(uuid())
  rfqId     String
  supplierId String
  field     String   // e.g., "closeDate", "quantity"
  reason    String
  status    String   @default("pending") // "pending", "approved", "rejected"
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  brfq      BRFQ     @relation(fields: [rfqId], references: [id])
}

model Award {
  id        String   @id @default(uuid())
  rfqId     String
  supplierId String
  awardedAt DateTime @default(now())
  comments  String?
  // You might want to store specific items awarded if partial award is allowed
  
  brfq      BRFQ     @relation(fields: [rfqId], references: [id])
}

model PauseRequest {
  id        String    @id @default(cuid())
  brfqId    String
  brfq      BRFQ      @relation(fields: [brfqId], references: [id])
  reason    String
  requestedBy String  // user ID or name
  status    String    @default("pending") // pending, approved, rejected
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  
  // Optional: approval details
  approvedBy String?
  approvedAt DateTime?
}

model PauseAction {
  id        String    @id @default(cuid())
  brfqId    String
  brfq      BRFQ      @relation(fields: [brfqId], references: [id])
  action    String    // "PAUSE" or "RESUME"
  reason    String?
  performedBy String
  timestamp DateTime  @default(now())
}

model Jurisdiction {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}


model Approver {
  id        String   @id @default(cuid())
  name      String
  email     String   @unique
  role      String
  
  userId    String?  @unique
  user      User?    @relation("UserApprover", fields: [userId], references: [id])
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@map("approvers")
}

model Otp {
  id        String   @id @default(cuid())
  email     String   @unique
  otp       String
  expiresAt DateTime
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@map("otps")
}

model ContractTemplate {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model ContractDuration {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model WarrantyPeriod {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model GoverningLaw {
  id        String      @id @default(cuid())
  name      String
  createdAt DateTime     @default(now()) @map(name: "created_at")
  updatedAt DateTime     @updatedAt @map(name: "updated_at")
}

model ApprovalWorkflowTemplate {
  id                    String                 @id @default(cuid())
  name                  String                 @default("Default Workflow")
  steps                 ApprovalStepTemplate[]
  
  defaultSla            String?
  allowParallel         Boolean                @default(false)
  sendReminders         Boolean                @default(true)
  allowDelegation       Boolean                @default(false)
  
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt
  
  @@map("approval_workflow_templates")
}

model ApprovalStepTemplate {
  id                    String                   @id @default(cuid())
  templateId            String
  template              ApprovalWorkflowTemplate @relation(fields: [templateId], references: [id], onDelete: Cascade)
  
  order                 Int
  role                  String
  approverName          String?
  
  slaDuration           String?
  condition             String?
  conditionType         String?
  conditionOperator     String?
  conditionValue        String?
  isRequired            Boolean                  @default(false)
  
  createdAt             DateTime                 @default(now())
  updatedAt             DateTime                 @updatedAt
  
  @@map("approval_step_templates")
}

model EventParticipation {
  id                   String             @id @default(cuid())
  supplierId           String
  procurementRequestId String
  status               String             // "ACCEPTED", "DECLINED"
  responseDate         DateTime           @default(now())

  supplier             Supplier           @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  procurementRequest   ProcurementRequest @relation(fields: [procurementRequestId], references: [id], onDelete: Cascade)

  @@unique([supplierId, procurementRequestId])
  @@map("event_participation")
}

model RfpResponse {
  id                   String             @id @default(cuid())
  
  supplierId           String
  supplier             Supplier           @relation(fields: [supplierId], references: [id], onDelete: Cascade)
  
  procurementRequestId String
  procurementRequest   ProcurementRequest @relation(fields: [procurementRequestId], references: [id], onDelete: Cascade)
  
  questionId           String             // UUID from the JSON 'questions' array
  answer               Json               // The actual answer: { value: "..." }
  
  createdAt            DateTime           @default(now())
  updatedAt            DateTime           @updatedAt
  
  @@unique([supplierId, procurementRequestId, questionId]) // One answer per question per supplier
  @@map("rfp_responses")
}


model Request {
  id             String    @id @default(cuid())
  description    String
  requestType    String
  category       String
  address        String?
  estimatedValue String?
  needByDate     String?   // storing as String for now to match draft state, or DateTime if we parse it
  items          Json?
  status         String    @default("PENDING")
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")
  userId         String?   // Optional link to user

  @@map("requests")
}
